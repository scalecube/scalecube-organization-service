Feature: Organization service members management - Kick-out member

  Organization Owner or Admin should be able to kick-out (remove) existing members from relevant organization.
  Nevertheless at leas one organization owner should be persisted


  #__________________________________________________POSITIVE___________________________________________________________

  #MPA-7229 (#1)
  Scenario: Successful kick-out (remove) of specific "member" from a relevant Organization
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    And the user "B" who have got the "userId" issued by relevant authority was invited to user's "A" organization with a "member" role
    When the user "A" requested to remove the user "B" from user's "A" organization
    Then user "B" should be removed from user's "A" organization
    And user "A" should get successful response with the empty object


  #MPA-7229 (#2)
  Scenario: Successful kick-out (remove) the "owner" and "member" from relevant Organization by another owner
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    And the user "B" who have got the "userId" issued by relevant authority was invited to user's "A" organization with an "owner" role
    And the user "C" who have got the "userId" issued by relevant authority was invited to user's "A" organization with a "member" role
    When the user "B" requested to remove each of the users "A" and "C" from user's "A" organization
    Then users "A" and "C" should be removed from user's "A" organization
    And user "B" should get successful responses with the empty object


  #MPA-7229 (#3)
  Scenario: Successful kick-out (remove) of the "admin" and "member" from relevant Organization by another "admin"
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    And each of the users "B" and "C" who have got the "userId" issued by relevant authority were invited to user's "A" organization both with "admin" role
    And the user "D" who have got the "userId" issued by relevant authority was invited to user's "A" organization with a "member" role
    When the user "B" requested to remove each of the users "C" and "D" from user's "A" organization
    Then users "C" and "D" should be removed from user's "A" organization
    And user "B" should get successful responses with the empty object


  #MPA-7229 (#4)
  Scenario: Successful kick-out (remove) one of the "owner" from relevant Organization by "admin"
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    And the user "B" who have got the "userId" issued by relevant authority was invited to user's "A" organization with an "owner" role
    And the user "C" who have got the "userId" issued by relevant authority was invited to user's "A" organization with an "admin" role
    When the user "C" requested to remove the user "B" from user's "A" organization
    Then user "B" should be removed from user's "A" organization
    And user "C" should get successful response with the empty object


  #MPA-7229 (#5)
  Scenario: Successful kick-out (remove) yourself as the "owner" from relevant Organization upon at least one another owner is persisted
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    And the user "B" who have got the "userId" issued by relevant authority was invited to user's "A" organization with an "owner" role
    When the user "A" requested to remove himself from own organization
    Then user "A" should be removed from user's "A" organization
    And user "A" should get successful response with the empty object


  #MPA-7229 (#6)
  Scenario: Successful kick-out (remove) yourself as the "admin" from relevant Organization
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    And the user "B" who have got the "userId" issued by relevant authority was invited to user's "A" organization with an "admin" role
    When the user "B" requested to remove himself from user's "A" organization
    Then user "B" should be removed from user's "A" organization
    And user "B" should get successful response with the empty object


  #__________________________________________________NEGATIVE___________________________________________________________

  #MPA-7229 (#7)
  Scenario: Fail to kick-out (remove) yourself as the single "owner" from relevant Organization
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    When the user "A" requested to remove himself from own organization
    Then user "A" should get an error message: "At least one Owner should be persisted in the organization: 'organizationId'"


  #MPA-7229 (#8)
  Scenario: Fail to kick-out (remove) the single owner from relevant Organization by the "admin"
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    And the user "B" who have got the "userId" issued by relevant authority was invited to user's "A" organization with an "admin" role
    When the user "B" requested to remove the user "A" from user's "A" organization
    Then user "B" should get an error message: "At least one Owner should be persisted in the organization: 'organizationId'"


  #MPA-7229 (#9)
  Scenario: Fail to kick-out (remove) specific member from relevant Organization upon the existing member (requester) got "member" role permission level
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    And each of the users "B" and "C" who have got the "userId" issued by relevant authority were invited to user's "A" organization with a "member" role
    When the user "B" requested to remove the user "C" from user's "A" organization
    Then user "B" should get an error message: "user: 'userId "B"', name: 'null', not in role Owner or Admin of organization: 'org "A" name'"


  #MPA-7229 (#10)
  Scenario: Fail to remove a specific "member" from from relevant Organization upon some of the existing (requester) managers was removed from the relevant organization
    Given the user "A" have got a valid "token" issued by relevant authority
    And only single organization "organizationId" with specified "name" and "email" already created and owned by user "A"
    And the user "B" who have got the "userId" issued by relevant authority was invited to user's "A" organization with an "owner" role
    And the user "B" requested to remove the user "A" from user's "A" organization
    When the user "A" requested to remove the user "B" from user's "A" former organization
    Then user "A" should get an error message: "user: 'userId "A"', name: 'null', not in role Owner or Admin of organization: 'org "A" name'"


  #MPA-7229 (#11)
  Scenario: Fail to remove the user from specific Organization if the token is invalid (expired)
    Given a user "D" have got the invalid either expired "token"
    When user "D" requested to remove some user from some organization
    Then user "D" should receive the error message: "Token verification failed"